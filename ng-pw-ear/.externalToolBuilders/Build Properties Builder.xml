<?xml version="1.0"?>

<project name="Build Properties Builder" default="build" basedir="..">
	<import file="${basedir}/build-path.xml" optional="true" />
	<property name="build-properties.jar.file" location="${pw-ear.root}/target/pw-ear/build-properties.jar" />

	<target name="build">
		<echo message="[pw-ear] Building build-properties web library..." />
		<if>
			<equals arg1="${project.properties.build.timestamp}" arg2="${maven.build.timestamp}" />
			<then>
				<tstamp>
					<format property="build.timestamp" pattern="${project.properties.maven.build.timestamp.format}" />
				</tstamp>
			</then>
			<else>
				<property name="build.timestamp" value="${project.properties.build.timestamp}" />
			</else>
		</if>
		<mkdir dir="${pw-ear.target.workspace}/build-properties/com/csc/fsg/life/build" />
		<propertyfile file="${pw-ear.target.workspace}/build-properties/com/csc/fsg/life/build/build.properties">
			<entry key="app.designator" value="${project.properties.pw.designator}" />
			<entry key="app.version" value="${project.properties.pw.version}" />
			<entry key="build.timestamp" value="${build.timestamp}" />
		</propertyfile>

		<mkdir dir="${pw-ear.root}/target/pw-ear" />
		<jar jarfile="${build-properties.jar.file}">
			<fileset dir="${pw-ear.target.workspace}/build-properties" />
		</jar>
		<delete dir="${pw-ear.target.workspace}/build-properties" failonerror="false" />
	</target>
</project>